import{s as P,n as k,d as D,o as S}from"../chunks/scheduler.ffbd56c5.js";import{S as V,i as j,s as b,g as _,D as w,f as r,c as v,h as x,j as g,k as h,a as f,x as E,m as z,z as C,n as A,o as L}from"../chunks/index.02aeeab6.js";import{g as I}from"../chunks/navigation.f767a769.js";import{p as H}from"../chunks/stores.f244effd.js";import{h as U}from"../chunks/google-direct.658b226e.js";function q(p){let n,o="❌",l,i,c="Login error",t,e,s,u,d,y="Try again";return{c(){n=_("div"),n.textContent=o,l=b(),i=_("h1"),i.textContent=c,t=b(),e=_("p"),s=z(p[1]),u=b(),d=_("a"),d.textContent=y,this.h()},l(a){n=x(a,"DIV",{class:!0,"data-svelte-h":!0}),C(n)!=="svelte-1xroobb"&&(n.textContent=o),l=v(a),i=x(a,"H1",{class:!0,"data-svelte-h":!0}),C(i)!=="svelte-161sr8d"&&(i.textContent=c),t=v(a),e=x(a,"P",{class:!0});var m=g(e);s=A(m,p[1]),m.forEach(r),u=v(a),d=x(a,"A",{href:!0,class:!0,"data-svelte-h":!0}),C(d)!=="svelte-itmwiz"&&(d.textContent=y),this.h()},h(){h(n,"class","text-red-600 mb-4"),h(i,"class","text-xl font-semibold text-red-600 mb-2"),h(e,"class","text-gray-600 mb-4"),h(d,"href","/auth"),h(d,"class","btn-eco")},m(a,m){f(a,n,m),f(a,l,m),f(a,i,m),f(a,t,m),f(a,e,m),E(e,s),f(a,u,m),f(a,d,m)},p(a,m){m&2&&L(s,a[1])},d(a){a&&(r(n),r(l),r(i),r(t),r(e),r(u),r(d))}}}function M(p){let n,o,l,i="Processing login...",c,t,e="Wait a moment";return{c(){n=_("div"),o=b(),l=_("h1"),l.textContent=i,c=b(),t=_("p"),t.textContent=e,this.h()},l(s){n=x(s,"DIV",{class:!0}),g(n).forEach(r),o=v(s),l=x(s,"H1",{class:!0,"data-svelte-h":!0}),C(l)!=="svelte-1t9uj43"&&(l.textContent=i),c=v(s),t=x(s,"P",{class:!0,"data-svelte-h":!0}),C(t)!=="svelte-oxe331"&&(t.textContent=e),this.h()},h(){h(n,"class","inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-eco-600 mb-4"),h(l,"class","text-xl font-semibold text-gray-900 mb-2"),h(t,"class","text-gray-600")},m(s,u){f(s,n,u),f(s,o,u),f(s,l,u),f(s,c,u),f(s,t,u)},p:k,d(s){s&&(r(n),r(o),r(l),r(c),r(t))}}}function R(p){let n,o,l;function i(e,s){if(e[0])return M;if(e[1])return q}let c=i(p),t=c&&c(p);return{c(){n=b(),o=_("div"),l=_("div"),t&&t.c(),this.h()},l(e){w("svelte-nnn3os",document.head).forEach(r),n=v(e),o=x(e,"DIV",{class:!0});var u=g(o);l=x(u,"DIV",{class:!0});var d=g(l);t&&t.l(d),d.forEach(r),u.forEach(r),this.h()},h(){document.title="Processing Login - EcoLink",h(l,"class","text-center"),h(o,"class","min-h-[80vh] flex items-center justify-center")},m(e,s){f(e,n,s),f(e,o,s),E(o,l),t&&t.m(l,null)},p(e,[s]){c===(c=i(e))&&t?t.p(e,s):(t&&t.d(1),t=c&&c(e),t&&(t.c(),t.m(l,null)))},i:k,o:k,d(e){e&&(r(n),r(o)),t&&t.d()}}}function T(p,n,o){let l;D(p,H,t=>o(2,l=t));let i=!0,c=null;return S(async()=>{const t=l.url.searchParams.get("code");if(!t){o(1,c="Authorization code not found"),o(0,i=!1);return}try{await U(t);const e=localStorage.getItem("ecolink_pending_url");e?(localStorage.removeItem("ecolink_pending_url"),I(`/?url=${encodeURIComponent(e)}`)):I("/dashboard")}catch(e){console.error("Callback error:",e),o(1,c=e.message||"Authentication error"),o(0,i=!1)}}),[i,c]}class K extends V{constructor(n){super(),j(this,n,T,R,P,{})}}export{K as component};
